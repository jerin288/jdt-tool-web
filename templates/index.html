<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JDT PDF to Excel Converter</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1><i class="fas fa-file-pdf"></i> JDT PDF to Excel Converter</h1>
            <p class="subtitle">Advanced PDF Extraction Tool - Web Edition</p>
            <div class="header-controls">
                <button id="darkModeToggle" class="icon-btn" title="Toggle Dark Mode">
                    <i class="fas fa-moon"></i>
                </button>
                <button id="historyBtn" class="icon-btn" title="View History">
                    <i class="fas fa-history"></i>
                </button>
                <button id="templatesBtn" class="icon-btn" title="Settings Templates">
                    <i class="fas fa-save"></i>
                </button>
            </div>
        </div>

        <!-- Main Form -->
        <form id="uploadForm" enctype="multipart/form-data">
            <!-- PDF File Selection -->
            <div class="form-section">
                <div class="section-header">
                    <i class="fas fa-folder-open"></i> Select PDF File
                </div>
                <div class="file-upload-wrapper">
                    <input type="file" id="pdfFile" name="pdf_file" accept=".pdf,application/pdf" required aria-label="PDF file input">
                    <label for="pdfFile" class="file-upload-label">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <span id="fileName">Choose PDF file or drag & drop here</span>
                    </label>
                    <div class="file-info" id="fileInfo"></div>
                </div>
            </div>

            <!-- Advanced Options -->
            <div class="form-section">
                <div class="section-header">
                    <i class="fas fa-cog"></i> Advanced Options
                </div>
                
                <div class="option-grid">
                    <!-- Page Range -->
                    <div class="option-group">
                        <label for="pageRange">Page Range:</label>
                        <input type="text" id="pageRange" name="page_range" value="all" 
                               placeholder="e.g., all, 1-3, 1,3,5" 
                               maxlength="100"
                               aria-label="Page range selection">
                        <small class="help-text">Specify pages to extract</small>
                    </div>

                    <!-- Extract Mode -->
                    <div class="option-group">
                        <label for="extractMode">Extract Mode:</label>
                        <select id="extractMode" name="extract_mode" aria-label="Data extraction mode">
                            <option value="tables">Tables Only</option>
                            <option value="text">Text Only</option>
                            <option value="both">Both Tables & Text</option>
                        </select>
                    </div>

                    <!-- Output Format -->
                    <div class="option-group">
                        <label for="outputFormat">Output Format:</label>
                        <select id="outputFormat" name="output_format" aria-label="Output file format">
                            <option value="xlsx">Excel (.xlsx)</option>
                            <option value="csv">CSV (.csv)</option>
                        </select>
                    </div>

                    <!-- PDF Password -->
                    <div class="option-group">
                        <label for="password">
                            <i class="fas fa-lock"></i> PDF Password:
                        </label>
                        <input type="password" id="password" name="password" 
                               placeholder="If encrypted" 
                               maxlength="100"
                               aria-label="PDF password if file is encrypted">
                    </div>
                </div>

                <!-- Checkboxes -->
                <div class="checkbox-group">
                    <label class="checkbox">
                        <input type="checkbox" id="mergeTables" name="merge_tables" value="true">
                        <span class="checkmark"></span>
                        <span>Merge All Tables</span>
                    </label>
                    
                    <label class="checkbox">
                        <input type="checkbox" id="includeHeaders" name="include_headers" value="true" checked>
                        <span class="checkmark"></span>
                        <span>Include Headers</span>
                    </label>
                    
                    <label class="checkbox">
                        <input type="checkbox" id="cleanData" name="clean_data" value="true" checked>
                        <span class="checkmark"></span>
                        <span>Clean Data</span>
                    </label>
                </div>
            </div>

            <!-- Template Controls -->
            <div class="template-controls">
                <select id="templateSelect" class="template-select">
                    <option value="">Load a template...</option>
                </select>
                <button type="button" id="saveTemplateBtn" class="template-btn" title="Save current settings as template">
                    <i class="fas fa-bookmark"></i> Save Template
                </button>
            </div>

            <!-- Convert Button -->
            <div class="button-wrapper">
                <button type="submit" id="convertBtn" class="convert-button">
                    <i class="fas fa-rocket"></i> Convert to Excel
                </button>
            </div>
        </form>

        <!-- Progress Section -->
        <div id="progressSection" class="progress-section" style="display: none;">
            <div class="progress-bar-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div class="status-message" id="statusMessage">Initializing...</div>
        </div>

        <!-- Result Section -->
        <div id="resultSection" class="result-section" style="display: none;">
            <div class="result-success">
                <i class="fas fa-check-circle"></i>
                <h3>Conversion Successful!</h3>
                <div id="resultDetails"></div>
                <div class="result-actions">
                    <button id="previewDataBtn" class="preview-button" style="display:none;">
                        <i class="fas fa-eye"></i> Preview Data
                    </button>
                    <button id="downloadBtn" class="download-button">
                        <i class="fas fa-download"></i> Download File
                    </button>
                </div>
                <button id="convertAnotherBtn" class="secondary-button">
                    <i class="fas fa-redo"></i> Convert Another
                </button>
            </div>
        </div>

        <!-- Error Section -->
        <div id="errorSection" class="error-section" style="display: none;">
            <div class="error-message">
                <i class="fas fa-exclamation-circle"></i>
                <h3>Conversion Failed</h3>
                <p id="errorMessage"></p>
                <button id="tryAgainBtn" class="secondary-button">
                    <i class="fas fa-redo"></i> Try Again
                </button>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>⚡ JDT Tools © 2025 | PDF to Excel Converter v2.0 Web Edition ⚡</p>
        </div>
    </div>

    <!-- Drag & Drop Overlay -->
    <div id="dropOverlay" class="drop-overlay" style="display: none;">
        <div class="drop-message">
            <i class="fas fa-file-pdf"></i>
            <p>Drop PDF file here</p>
        </div>
    </div>

    <!-- Data Preview Modal -->
    <div id="previewModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-table"></i> Data Preview</h2>
                <button class="modal-close" id="closePreviewModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="previewContent">
                <div class="preview-info"></div>
                <div class="preview-table-wrapper"></div>
            </div>
        </div>
    </div>

    <!-- History Modal -->
    <div id="historyModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-history"></i> Conversion History</h2>
                <button class="modal-close" id="closeHistoryModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="historyContent">
                <div class="history-list"></div>
            </div>
        </div>
    </div>

    <!-- Template Save Modal -->
    <div id="templateModal" class="modal" style="display: none;">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2><i class="fas fa-save"></i> Save Settings Template</h2>
                <button class="modal-close" id="closeTemplateModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <label for="templateName">Template Name:</label>
                <input type="text" id="templateName" placeholder="e.g., Financial Reports" class="template-input">
                <div class="modal-actions">
                    <button id="saveTemplateConfirm" class="modal-btn primary">
                        <i class="fas fa-check"></i> Save
                    </button>
                    <button id="cancelTemplateSave" class="modal-btn secondary">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>